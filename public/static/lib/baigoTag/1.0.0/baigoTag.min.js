!function(t){t.fn.baigoTag=function(e){"use strict";if(this.length<1)return this;var a=t(this),i=[],n=[],r=t.extend(!0,{maxTags:5,minChar:0,addOnBlur:!0,confirmKeycodes:[13,186,188],class_name:{tag_list:"bg-tag-list",tag_item:"bg-tag-item"},selector:{tag_list:".bg-tag-list",tag_item:".bg-tag-item"},tpl:{tag_list:'<div class="bg-tag-list"></div>'},remote:{url:"",wildcard:"%KEY"},highlight:!0},e),l=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,remote:r.remote});l.initialize();var s={source:l.ttAdapter()},o={highlight:r.highlight},g=a.attr("name"),c=a.attr("id");void 0===c&&(c=g);var d='<input type="hidden" name="'+g+'_hidden" id="'+c+'_hidden">';if(t("#"+c+"_hidden").length<1&&a.before(d),t(r.selector.tag_list).length<1&&a.before(r.tpl.tag_list),void 0!==s.source){var u=a.typeahead(o,s);u.bind("typeahead:select",function(t,e){h.pushTag(e)})}r.addOnBlur&&a.blur(function(){var e=t(this).val();h.pushTag(e)}),a.keyup(function(e){var a=t(this).val();r.minChar>0&&a.length>=r.minChar&&h.pushTag(a),t.inArray(e.keyCode,r.confirmKeycodes)>=0&&(n.push(e.key),h.pushTag(a))});var h={indexData:function(t){for(var e=0;e<i.length;e++)if(i[e]==t)return e;return-1},deleteData:function(t){var e=h.indexData(t);e>-1&&i.splice(e,1)},putVal:function(){t("#"+c+"_hidden").val(i.toString())},inputEmpty:function(){a.val(""),void 0!==u&&a.typeahead("val","")},pushTag:function(e){if("string"==typeof e&&(e=h.valProcess(e)).length>0&&i.length<r.maxTags&&t.inArray(e,i)<0){var a='<div class="'+r.class_name.tag_item+'" id="tag_'+e.replace(/ /g,"_")+'">'+e+'<span data-act="remove" data-tag="'+e.replace(/ /g,"_")+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg></span></div>';t(r.selector.tag_list).append(a),i.push(e),h.putVal(),h.inputEmpty()}},valProcess:function(t){if(void 0===t)return"";t=(t=(t=t.trim()).replace(/<\/?[^>]*>/g,"")).replace(/\n[\s||]*\r/g,"\n");for(var e=0;e<n.length;e++)t=t.replace(n[e],"");return t}},p={add:function(e){t.isArray(e)?t.each(e,function(t,e){h.pushTag(e)}):h.pushTag(e)},remove:function(e){t("#tag_"+e).remove(),h.deleteData(e),h.putVal()},getTags:function(){return i}};return t(r.selector.tag_list).on("click",'[data-act="remove"]',function(){var e=t(this).data("tag");p.remove(e)}),p}}(jQuery);